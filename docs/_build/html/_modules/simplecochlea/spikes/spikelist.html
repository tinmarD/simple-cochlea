<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>simplecochlea.spikes.spikelist &#8212; simplecochlea  documentation</title>
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/gallery.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/my-styles.css" type="text/css" />
    <script type="text/javascript" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../index.html">
          simplecochlea</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../../rst/modules.html">API</a></li>
                <li><a href="../../../auto_examples/index.html">Examples</a></li>
                <li><a href="../../../rst/install.html">Install</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary">
<form action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-9 content">
      
  <h1>Source code for simplecochlea.spikes.spikelist</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">scipy.io</span> <span class="k">as</span> <span class="nn">sio</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">pymuvr</span>
    <span class="n">HAS_PYMUVR</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">HAS_PYMUVR</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">&#39;paper&#39;</span><span class="p">)</span>


<div class="viewcode-block" id="SpikeList"><a class="viewcode-back" href="../../../rst/simplecochlea.spikes.html#simplecochlea.spikes.spikelist.SpikeList">[docs]</a><span class="k">class</span> <span class="nc">SpikeList</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; SpikeList Class.</span>
<span class="sd">    A spike is defined by a time and a channel. In addition a pattern ID ad a potential can be assigned to spikes.</span>
<span class="sd">    These characteristics are defined as list.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    time : array</span>
<span class="sd">        Time of each spike (in seconds)</span>
<span class="sd">    channel : array [int]</span>
<span class="sd">        Channel of each spike</span>
<span class="sd">    pattern_id : array [int]</span>
<span class="sd">        Pattern ID of each spike (Optional). If not defined is nan</span>
<span class="sd">    potential : array</span>
<span class="sd">        Spikes potential (Optional). If not defined is 0</span>
<span class="sd">    n_channels : int</span>
<span class="sd">        Number of channels in the spikelist</span>
<span class="sd">    n_spikes : int</span>
<span class="sd">        Number of spikes in the spikelist</span>
<span class="sd">    name : str</span>
<span class="sd">        Spikelist name</span>
<span class="sd">    tmin : float</span>
<span class="sd">        Starting time of the spikelist (default: 0)</span>

<span class="sd">        .. note:: For spikelist generating by running a signal through the cochlea, the tmin attribute is not the</span>
<span class="sd">                  time of the first spike but the starting time of the signal (0 usually).</span>

<span class="sd">    tmax : float</span>
<span class="sd">        Ending time of the spikelist. If not given, tmax is set to the maximal spike time</span>

<span class="sd">        .. note:: For spikelist generating by running a signal through the cochlea, the tmax attribute should not be the</span>
<span class="sd">                  time of the last spike but the ending time of the signal.</span>

<span class="sd">    pattern_names : dict</span>
<span class="sd">        Dictionnary giving a label to each pattern defined by pattern_id</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="p">[],</span> <span class="n">channel</span><span class="o">=</span><span class="p">[],</span> <span class="n">pattern_id</span><span class="o">=</span><span class="p">[],</span> <span class="n">potential</span><span class="o">=</span><span class="p">[],</span> <span class="n">n_channels</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">tmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">tmax</span><span class="o">=</span><span class="p">[],</span> <span class="n">pattern_names</span><span class="o">=</span><span class="p">{}):</span>
        <span class="n">time</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">pattern_id</span><span class="p">,</span> <span class="n">potential</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">time</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pattern_id</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span>\
                                               <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">potential</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">channel</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">channel</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">time</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;SpikeList time must be associated with a channel&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">channel</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">time</span><span class="p">])</span> <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
            <span class="n">channel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">channel</span><span class="p">])</span> <span class="k">if</span> <span class="n">channel</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">n_channels</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">n_channels</span> <span class="o">=</span> <span class="n">channel</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">channel</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Spikelist arguments time and channel must have the same length&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pattern_id</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">pattern_id</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">pattern_id</span> <span class="o">=</span> <span class="n">pattern_id</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pattern_id</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">pattern_id</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Spikelist argument pattern_id must either be empty, a scalar or a vector with &#39;</span>
                                 <span class="s1">&#39;the same length that time and channel arguments&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">potential</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">potential</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">potential</span> <span class="o">=</span> <span class="n">potential</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">potential</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">potential</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Spikelist argument potential must either be empty, a scalar or a vector with &#39;</span>
                                 <span class="s1">&#39;the same length that time and channel arguments&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Spikelist argument name must be a string&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tmin</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">tmin</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;SpikeList argument tmin must be a scalar&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tmax</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">tmax</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;SpikeList argument tmax must be a scalar&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">tmax</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">n_spikes</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">tmax</span><span class="p">:</span>
                <span class="n">tmax</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="n">n_spikes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pattern_id</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">pattern_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_spikes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">potential</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">potential</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_spikes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="n">time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channel</span> <span class="o">=</span> <span class="n">channel</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pattern_id</span> <span class="o">=</span> <span class="n">pattern_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">potential</span> <span class="o">=</span> <span class="n">potential</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_spikes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span> <span class="o">=</span> <span class="n">n_channels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tmin</span> <span class="o">=</span> <span class="n">tmin</span> <span class="k">if</span> <span class="n">tmin</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tmax</span> <span class="o">=</span> <span class="n">tmax</span>
        <span class="k">if</span> <span class="n">pattern_names</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pattern_names</span> <span class="o">=</span> <span class="n">pattern_names</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">patterns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pattern_id</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pattern_id</span><span class="p">)])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pattern_names</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">patterns</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;pattern </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">patterns</span><span class="p">))]))</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;SpikeList class with </span><span class="si">{}</span><span class="s1"> spikes, </span><span class="si">{}</span><span class="s1"> channels&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_spikes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
            <span class="n">description</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> - name : </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">patterns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pattern_id</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pattern_id</span><span class="p">)])</span>
        <span class="n">n_patterns</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">patterns</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n_patterns</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">description</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> - </span><span class="si">{}</span><span class="s1"> patterns&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n_patterns</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pattern_names</span><span class="p">:</span>
            <span class="n">description</span> <span class="o">+=</span> <span class="s1">&#39; : </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pattern_names</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">description</span>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_spikes</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Select of subset of the spikelist given the argument item</span>

<span class="sd">          Examples</span>
<span class="sd">          --------</span>

<span class="sd">          Get the 100 first spikes ::</span>

<span class="sd">           &gt;&gt;&gt; spikelist_sel = spikelist[:100]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pattern_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pattern_id</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
        <span class="n">pattern_ids</span> <span class="o">=</span> <span class="n">pattern_ids</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">pattern_ids</span><span class="p">)]</span>
        <span class="n">pattern_names</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pattern_names</span><span class="p">[</span><span class="n">pat_id</span><span class="p">]</span> <span class="k">for</span> <span class="n">pat_id</span> <span class="ow">in</span> <span class="n">pattern_ids</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">SpikeList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">item</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel</span><span class="p">[</span><span class="n">item</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">pattern_id</span><span class="p">[</span><span class="n">item</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">potential</span><span class="p">[</span><span class="n">item</span><span class="p">],</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmax</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">pattern_ids</span><span class="p">,</span> <span class="n">pattern_names</span><span class="p">)))</span>

<div class="viewcode-block" id="SpikeList.sort"><a class="viewcode-back" href="../../../rst/simplecochlea.spikes.html#simplecochlea.spikes.spikelist.SpikeList.sort">[docs]</a>    <span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Sort the spikelist by increasing attribute, selected by field</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        field : str</span>
<span class="sd">            Attribute to sort the spikelist. Must be in  [&#39;time&#39;, &#39;channel&#39;, &#39;pattern_id&#39;, &#39;potential&#39;]</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="n">field</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;channel&#39;</span><span class="p">,</span> <span class="s1">&#39;pattern_id&#39;</span><span class="p">,</span> <span class="s1">&#39;potential&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Argument field must be a string, either time, channel, pattern_id, or potential&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field</span> <span class="ow">is</span> <span class="s1">&#39;time&#39;</span><span class="p">:</span>
            <span class="n">sort_vect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">field</span> <span class="ow">is</span> <span class="s1">&#39;channel&#39;</span><span class="p">:</span>
            <span class="n">sort_vect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">field</span> <span class="ow">is</span> <span class="s1">&#39;pattern_id&#39;</span><span class="p">:</span>
            <span class="n">sort_vect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pattern_id</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">field</span> <span class="ow">is</span> <span class="s1">&#39;potential&#39;</span><span class="p">:</span>
            <span class="n">sort_vect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">potential</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">sort_vect</span><span class="p">]</span></div>

<div class="viewcode-block" id="SpikeList.add_time_offset"><a class="viewcode-back" href="../../../rst/simplecochlea.spikes.html#simplecochlea.spikes.spikelist.SpikeList.add_time_offset">[docs]</a>    <span class="k">def</span> <span class="nf">add_time_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t_offset</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Add a time offset to the spikes time. Used when creating list of spikelists.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">t_offset</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Argument t_offset should be a scalar&#39;</span><span class="p">)</span>
        <span class="n">spklist_offset</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="n">spklist_offset</span><span class="o">.</span><span class="n">tmin</span> <span class="o">+=</span> <span class="n">t_offset</span>
        <span class="n">spklist_offset</span><span class="o">.</span><span class="n">tmax</span> <span class="o">+=</span> <span class="n">t_offset</span>
        <span class="n">spklist_offset</span><span class="o">.</span><span class="n">time</span> <span class="o">+=</span> <span class="n">t_offset</span>
        <span class="k">return</span> <span class="n">spklist_offset</span></div>

<div class="viewcode-block" id="SpikeList.select_spike"><a class="viewcode-back" href="../../../rst/simplecochlea.spikes.html#simplecochlea.spikes.spikelist.SpikeList.select_spike">[docs]</a>    <span class="k">def</span> <span class="nf">select_spike</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_min</span><span class="o">=</span><span class="p">[],</span> <span class="n">time_max</span><span class="o">=</span><span class="p">[],</span> <span class="n">channel_sel</span><span class="o">=</span><span class="p">[],</span> <span class="n">potential_min</span><span class="o">=</span><span class="p">[],</span> <span class="n">potential_max</span><span class="o">=</span><span class="p">[],</span>
                     <span class="n">pattern_id_sel</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot; Select a subset of the spikelist. If multiples selection parameters are given, select the spikes meeting</span>
<span class="sd">        all conditions.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        time_min : float (s) | None</span>
<span class="sd">            Select spikes whose time is superior or equal to time_min</span>
<span class="sd">        time_max : float (s) | None</span>
<span class="sd">            Select spikes whose time is inferior or equal to time_max</span>
<span class="sd">        channel_sel : list | array | None</span>
<span class="sd">            Select spikes whose channel is in channel_sel</span>
<span class="sd">        potential_min : float | None</span>
<span class="sd">            Select spikes whose potential is superior or equal to potential_min</span>
<span class="sd">        potential_max : float | None</span>
<span class="sd">            Select spikes whose potential is inferior or equal to potential_max</span>
<span class="sd">        pattern_id_sel : int</span>
<span class="sd">            Select spikes whose pattern_id is equal to pattern_id_sel</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        sel_ind : array [bool]</span>
<span class="sd">            Boolean array representing selected spikes</span>
<span class="sd">        spikelist_sel : SpikeList</span>
<span class="sd">            Selected SpikeList</span>
<span class="sd">        n_spikes : int</span>
<span class="sd">            Number of spikes in the selected spikelist</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">time_min</span><span class="p">,</span> <span class="n">time_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">time_min</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">time_max</span><span class="p">)</span>
        <span class="n">potential_min</span><span class="p">,</span> <span class="n">potential_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">potential_min</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">potential_max</span><span class="p">])</span>
        <span class="n">channel_sel</span><span class="p">,</span> <span class="n">pattern_id_sel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">channel_sel</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pattern_id_sel</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">time_min</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">time_max</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">channel_sel</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">pattern_id_sel</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Arguments should be scalar or single value arrays&#39;</span><span class="p">)</span>
        <span class="n">sel_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_spikes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">time_min</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sel_ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">&gt;=</span> <span class="n">time_min</span>
        <span class="k">if</span> <span class="n">time_max</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sel_ind</span> <span class="o">=</span> <span class="n">sel_ind</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">&lt;</span> <span class="n">time_max</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">channel_sel</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sel_ind</span> <span class="o">=</span> <span class="n">sel_ind</span> <span class="o">&amp;</span> <span class="n">np</span><span class="o">.</span><span class="n">in1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channel</span><span class="p">,</span> <span class="n">channel_sel</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">potential_min</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sel_ind</span> <span class="o">=</span> <span class="n">sel_ind</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">potential</span> <span class="o">&gt;=</span> <span class="n">potential_min</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">potential_max</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sel_ind</span> <span class="o">=</span> <span class="n">sel_ind</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">potential</span> <span class="o">&lt;</span> <span class="n">potential_max</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pattern_id_sel</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">pattern_id</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sel_ind</span> <span class="o">=</span> <span class="n">sel_ind</span> <span class="o">&amp;</span> <span class="n">np</span><span class="o">.</span><span class="n">in1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pattern_id</span><span class="p">,</span> <span class="n">pattern_id_sel</span><span class="p">)</span>
        <span class="n">sel_ind_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sel_ind</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">sel_ind_pos</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">spikelist_sel</span> <span class="o">=</span> <span class="n">SpikeList</span><span class="p">(</span><span class="n">n_channels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">,</span> <span class="n">tmin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tmax</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">spikelist_sel</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">sel_ind_pos</span><span class="p">]</span>
        <span class="n">n_spikes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sel_ind</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sel_ind</span><span class="p">,</span> <span class="n">spikelist_sel</span><span class="p">,</span> <span class="n">n_spikes</span></div>

<div class="viewcode-block" id="SpikeList.set_pattern_id_from_time_limits"><a class="viewcode-back" href="../../../rst/simplecochlea.spikes.html#simplecochlea.spikes.spikelist.SpikeList.set_pattern_id_from_time_limits">[docs]</a>    <span class="k">def</span> <span class="nf">set_pattern_id_from_time_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t_start</span><span class="p">,</span> <span class="n">t_end</span><span class="p">,</span> <span class="n">pattern_id</span><span class="p">,</span> <span class="n">pattern_dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Given time limits given by t_start and t_end, set the pattern_id of spikes in this time interval.</span>
<span class="sd">         Also add entries to the pattern_names dictionnary of the spikelist.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        t_start : array</span>
<span class="sd">            Start of each time period (s)</span>
<span class="sd">        t_end : array</span>
<span class="sd">            End of each time period (s)</span>
<span class="sd">        pattern_id : array [int]</span>
<span class="sd">            Pattern ID of each time period</span>
<span class="sd">        pattern_dict :</span>
<span class="sd">            Dictionnary given the labels associated with each different pattern ID.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t_start</span><span class="p">,</span> <span class="n">t_end</span><span class="p">,</span> <span class="n">pattern_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">t_start</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">t_end</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pattern_id</span><span class="p">)</span>
        <span class="n">t_start</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">t_start</span><span class="p">])</span> <span class="k">if</span> <span class="n">t_start</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">t_start</span>
        <span class="n">t_end</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">t_end</span><span class="p">])</span> <span class="k">if</span> <span class="n">t_end</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">t_end</span>
        <span class="n">pattern_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">pattern_id</span><span class="p">])</span> <span class="k">if</span> <span class="n">pattern_id</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">pattern_id</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">t_start</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">t_end</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">pattern_id</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Arguments t_start, t_end and pattern_id must have the same size&#39;</span><span class="p">)</span>
        <span class="n">unique_pattern_id</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">pattern_id</span><span class="p">,</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">pat_id_i</span> <span class="ow">in</span> <span class="n">unique_pattern_id</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pattern_names</span><span class="p">[</span><span class="n">pat_id_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pattern_dict</span><span class="p">[</span><span class="n">pat_id_i</span><span class="p">]</span>
        <span class="n">n_periods</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_start</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_periods</span><span class="p">):</span>
            <span class="n">sel_ind_i</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_spike</span><span class="p">(</span><span class="n">time_min</span><span class="o">=</span><span class="n">t_start</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">time_max</span><span class="o">=</span><span class="n">t_end</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.001</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pattern_id</span><span class="p">[</span><span class="n">sel_ind_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pattern_id</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></div>

<div class="viewcode-block" id="SpikeList.set_pattern_id_from_time_limits_old"><a class="viewcode-back" href="../../../rst/simplecochlea.spikes.html#simplecochlea.spikes.spikelist.SpikeList.set_pattern_id_from_time_limits_old">[docs]</a>    <span class="k">def</span> <span class="nf">set_pattern_id_from_time_limits_old</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t_start</span><span class="p">,</span> <span class="n">t_end</span><span class="p">,</span> <span class="n">pattern_id</span><span class="p">,</span> <span class="n">pattern_names</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot; Deprecated - Use set_pattern_id_from_time_limits &quot;&quot;&quot;</span>
        <span class="n">t_start</span><span class="p">,</span> <span class="n">t_end</span><span class="p">,</span> <span class="n">pattern_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">t_start</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">t_end</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pattern_id</span><span class="p">)</span>
        <span class="n">t_start</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">t_start</span><span class="p">])</span> <span class="k">if</span> <span class="n">t_start</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">t_start</span>
        <span class="n">t_end</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">t_end</span><span class="p">])</span> <span class="k">if</span> <span class="n">t_end</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">t_end</span>
        <span class="n">pattern_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">pattern_id</span><span class="p">])</span> <span class="k">if</span> <span class="n">pattern_id</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">pattern_id</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_start</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_end</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">pattern_id</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Arguments t_start, t_end and pattern_id must have the same length&#39;</span><span class="p">)</span>
        <span class="n">unique_pattern_id</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">pattern_id</span><span class="p">,</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">pat_id_i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">unique_pattern_id</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pattern_names</span><span class="p">[</span><span class="n">pat_id_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pattern_names</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">n_periods</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_start</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_periods</span><span class="p">):</span>
            <span class="n">sel_ind_i</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_spike</span><span class="p">(</span><span class="n">time_min</span><span class="o">=</span><span class="n">t_start</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">time_max</span><span class="o">=</span><span class="n">t_end</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.001</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pattern_id</span><span class="p">[</span><span class="n">sel_ind_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pattern_id</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></div>

<div class="viewcode-block" id="SpikeList.get_pattern_results"><a class="viewcode-back" href="../../../rst/simplecochlea.spikes.html#simplecochlea.spikes.spikelist.SpikeList.get_pattern_results">[docs]</a>    <span class="k">def</span> <span class="nf">get_pattern_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t_start</span><span class="p">,</span> <span class="n">t_end</span><span class="p">,</span> <span class="n">pattern_id</span><span class="p">,</span> <span class="n">pattern_names</span><span class="o">=</span><span class="p">[],</span> <span class="n">min_potential</span><span class="o">=</span><span class="p">[],</span> <span class="n">do_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">fig_title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Compute the number of spikes per segment. Segments are defined by ``t_start`` and ``t_end``. There might be</span>
<span class="sd">        multiples patterns, defined by ``pattern_id`` and ``pattern_names``.</span>
<span class="sd">        If ``min_potential`` is defined, select only the spikes whose potential is higher than this.</span>
<span class="sd">        If ``do_plot`` is true, plot the results.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        t_start : array</span>
<span class="sd">            Starting times of the segments (s)</span>
<span class="sd">        t_end : array</span>
<span class="sd">            Ending times of the segments (s)</span>
<span class="sd">        pattern_id : array</span>
<span class="sd">            Pattern id of the segments</span>
<span class="sd">        pattern_names : array | None</span>
<span class="sd">            Pattern name of the segments</span>
<span class="sd">        min_potential : float | None</span>
<span class="sd">            If defined select only spikes whose potential is higher than this</span>
<span class="sd">        do_plot : bool | None (default: True)</span>
<span class="sd">            If true, plot the results</span>
<span class="sd">        fig_title : str | None</span>
<span class="sd">            Figure&#39;s title</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        n_spikes_mean : array (size n_patterns)</span>
<span class="sd">            Mean number of spikes across repetition for each pattern</span>
<span class="sd">        n_spikes_per_chunk : array  (size n_segments)</span>
<span class="sd">            Number of spikes for each segment</span>
<span class="sd">        n_active_chan_mean : array (size n_pattern)</span>
<span class="sd">            Mean number of active channel across repetition for each pattern</span>
<span class="sd">        n_active_chan_per_chunk : array (size n_segments)</span>
<span class="sd">            Number of active channel for each segment</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t_start</span><span class="p">,</span> <span class="n">t_end</span><span class="p">,</span> <span class="n">pattern_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">t_start</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">t_end</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pattern_id</span><span class="p">)</span>
        <span class="n">t_start</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">t_start</span><span class="p">])</span> <span class="k">if</span> <span class="n">t_start</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">t_start</span>
        <span class="n">t_end</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">t_end</span><span class="p">])</span> <span class="k">if</span> <span class="n">t_end</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">t_end</span>
        <span class="n">pattern_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">pattern_id</span><span class="p">])</span> <span class="k">if</span> <span class="n">pattern_id</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">pattern_id</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_start</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_end</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">pattern_id</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Arguments t_start, t_end and pattern_id must have the same length&#39;</span><span class="p">)</span>
        <span class="n">unique_pattern_id</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">pattern_id</span><span class="p">,</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">n_patterns</span> <span class="o">=</span> <span class="n">unique_pattern_id</span><span class="o">.</span><span class="n">size</span>
        <span class="n">n_chunks</span> <span class="o">=</span> <span class="n">pattern_id</span><span class="o">.</span><span class="n">size</span>
        <span class="n">n_spikes_per_chunk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_chunks</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">n_active_chan_per_chunk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_chunks</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">n_spikes_mean</span><span class="p">,</span> <span class="n">n_active_chan_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_patterns</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_patterns</span><span class="p">)</span>
        <span class="n">n_repets_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_patterns</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">n_repets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_chunks</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_chunks</span><span class="p">):</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">spikelist_i</span><span class="p">,</span> <span class="n">n_spikes_per_chunk</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_spike</span><span class="p">(</span><span class="n">t_start</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">t_end</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">potential_min</span><span class="o">=</span><span class="n">min_potential</span><span class="p">)</span>
            <span class="n">n_active_chan_per_chunk</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">spikelist_i</span><span class="o">.</span><span class="n">channel</span><span class="p">)</span><span class="o">.</span><span class="n">size</span>
            <span class="n">pat_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">unique_pattern_id</span> <span class="o">==</span> <span class="n">pattern_id</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">n_repets_i</span><span class="p">[</span><span class="n">pat_pos</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">n_repets</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_repets_i</span><span class="p">[</span><span class="n">pat_pos</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="nb">id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">unique_pattern_id</span><span class="p">):</span>
            <span class="n">n_spikes_mean</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">n_spikes_per_chunk</span><span class="p">[</span><span class="n">pattern_id</span> <span class="o">==</span> <span class="nb">id</span><span class="p">])</span>
            <span class="n">n_active_chan_mean</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">n_active_chan_per_chunk</span><span class="p">[</span><span class="n">pattern_id</span> <span class="o">==</span> <span class="nb">id</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">do_plot</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_chunks</span><span class="p">),</span> <span class="s1">&#39;n_spikes&#39;</span><span class="p">:</span> <span class="n">n_spikes_per_chunk</span><span class="p">,</span>
                 <span class="s1">&#39;n_active_channels&#39;</span><span class="p">:</span> <span class="n">n_active_chan_per_chunk</span><span class="p">,</span> <span class="s1">&#39;pattern_name&#39;</span><span class="p">:</span> <span class="n">pattern_names</span><span class="p">,</span> <span class="s1">&#39;n_repet&#39;</span><span class="p">:</span> <span class="n">n_repets</span><span class="p">}</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">factorplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;n_repet&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;n_spikes&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;pattern_name&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">legend_out</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">min_potential</span><span class="p">:</span>
                <span class="n">fig_title</span> <span class="o">+=</span> <span class="s1">&#39; - min_potential = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">min_potential</span><span class="p">)</span>
            <span class="n">g</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">fig_title</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">n_spikes_mean</span><span class="p">,</span> <span class="n">n_spikes_per_chunk</span><span class="p">,</span> <span class="n">n_active_chan_mean</span><span class="p">,</span> <span class="n">n_active_chan_per_chunk</span></div>

<div class="viewcode-block" id="SpikeList.epoch"><a class="viewcode-back" href="../../../rst/simplecochlea.spikes.html#simplecochlea.spikes.spikelist.SpikeList.epoch">[docs]</a>    <span class="k">def</span> <span class="nf">epoch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t_start</span><span class="p">,</span> <span class="n">t_end</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Epoch the spikelist given the time periods defined by ``t_start`` and ``t_end``. Returns a SpikeList_list</span>
<span class="sd">        instance.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        t_start : array</span>
<span class="sd">            Start of each time period (s)</span>
<span class="sd">        t_end : array</span>
<span class="sd">            End of each time period (s)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        spikelist_list : SpikeList_list</span>
<span class="sd">            A SpikeList_list instance.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t_start</span><span class="p">,</span> <span class="n">t_end</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">t_start</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">t_end</span><span class="p">)</span>
        <span class="n">t_start</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">t_start</span><span class="p">])</span> <span class="k">if</span> <span class="n">t_start</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">t_start</span>
        <span class="n">t_end</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">t_end</span><span class="p">])</span> <span class="k">if</span> <span class="n">t_end</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">t_end</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">t_start</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">t_end</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Arguments t_start, t_end must have the same length&#39;</span><span class="p">)</span>
        <span class="n">n_epochs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_start</span><span class="p">)</span>
        <span class="n">spikelist_epochs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_epochs</span><span class="p">):</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">epoch_i</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_spike</span><span class="p">(</span><span class="n">time_min</span><span class="o">=</span><span class="n">t_start</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">time_max</span><span class="o">=</span><span class="n">t_end</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">spikelist_epochs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">epoch_i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">SpikeList_list</span><span class="p">(</span><span class="n">spikelist_epochs</span><span class="p">,</span> <span class="n">t_start</span><span class="p">,</span> <span class="n">t_end</span><span class="p">)</span></div>

<div class="viewcode-block" id="SpikeList.epoch_on_triggers"><a class="viewcode-back" href="../../../rst/simplecochlea.spikes.html#simplecochlea.spikes.spikelist.SpikeList.epoch_on_triggers">[docs]</a>    <span class="k">def</span> <span class="nf">epoch_on_triggers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t_triggers</span><span class="p">,</span> <span class="n">time_pre</span><span class="p">,</span> <span class="n">time_post</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Apply the epoch function on each trigger whose time is defined by t_triggers.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        t_triggers : array</span>
<span class="sd">            Time of each trigger (s)</span>
<span class="sd">        time_pre : float</span>
<span class="sd">            Time to keep before triggers</span>
<span class="sd">        time_post : float</span>
<span class="sd">            Time to keep after triggers</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        spikelist_list : SpikeList_list</span>
<span class="sd">            A SpikeList_list instance.</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">epoch</span><span class="p">(</span><span class="n">t_start</span><span class="o">=</span><span class="n">t_triggers</span> <span class="o">-</span> <span class="n">time_pre</span><span class="p">,</span> <span class="n">t_end</span><span class="o">=</span><span class="n">t_triggers</span><span class="o">+</span><span class="n">time_post</span><span class="p">)</span></div>

<div class="viewcode-block" id="SpikeList.plot"><a class="viewcode-back" href="../../../rst/simplecochlea.spikes.html#simplecochlea.spikes.spikelist.SpikeList.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bin_duration</span><span class="o">=</span><span class="mf">0.002</span><span class="p">,</span> <span class="n">potential_thresh</span><span class="o">=</span><span class="p">[],</span> <span class="n">ax_list</span><span class="o">=</span><span class="p">[],</span> <span class="n">minplot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">tau_lif</span><span class="o">=</span><span class="p">[],</span> <span class="n">pattern_id_sel</span><span class="o">=</span><span class="p">[],</span>
             <span class="n">color</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot; Plot the spikelist. The main central axis plots the spike list, one dot for each spike. Each pattern has</span>
<span class="sd">        a different color. The bottom axis plots the histogram of the spikes for all channels. The right axis sums up</span>
<span class="sd">        the spikes over time for each channel. The left axis plot the median ISI (Inter-Spike Interval), and if the</span>
<span class="sd">        ``tau_lif`` parameter is given, the ratio  ISI_med / Tau_Lif is also plotted.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bin_duration : float (default: 0.002s)</span>
<span class="sd">            Bin duration in seconds for the time histogram, in the bottom axis.</span>
<span class="sd">        potential_thresh : float | none (default)</span>
<span class="sd">            Potential threshold, only spike whose potential is higher than this value will be plotted. If none, plot</span>
<span class="sd">            all the spikes.</span>
<span class="sd">        ax_list : list | none (default)</span>
<span class="sd">            Axis handles to plot on. If none, create new axes.</span>
<span class="sd">        minplot : bool (default: False)</span>
<span class="sd">            If True, plot only the central plot.</span>
<span class="sd">        tau_lif : float | array | none (default)</span>
<span class="sd">            Tau parameter of the LIF bank of the cochlea. If provided, the ratio ISI_med / Tau_Lif is plotted on the</span>
<span class="sd">            left axis.</span>
<span class="sd">        pattern_id_sel : int | none (default)</span>
<span class="sd">            Pattern to select. If provided, the spikes of the selected pattern will appears on a different color in</span>
<span class="sd">            the left and right axes.</span>
<span class="sd">        color : list | array | none (default)</span>
<span class="sd">            Color of the patterns. If none, use default color</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ax_list : list</span>
<span class="sd">            List of the axes [central, bottom, right, left]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_spikes</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No Spikes in spikelist </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">ax_list</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ax_list</span><span class="p">)</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span> <span class="o">=</span> <span class="n">ax_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ax_list</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ax_list</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">ax_list</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ax_list</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ax_list</span><span class="p">)</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ax0</span> <span class="o">=</span> <span class="n">ax_list</span>
        <span class="k">if</span> <span class="n">potential_thresh</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">spklist_sel</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_spike</span><span class="p">(</span><span class="n">potential_min</span><span class="o">=</span><span class="n">potential_thresh</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">spklist_sel</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Empty spike list&#39;</span><span class="p">)</span>
                <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">spklist_sel</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="n">tau_lif</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tau_lif</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tau_lif</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">tau_lif</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Argument tau_lif should have a length of n_channels&#39;</span><span class="p">)</span>
        <span class="n">patterns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">spklist_sel</span><span class="o">.</span><span class="n">pattern_id</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">spklist_sel</span><span class="o">.</span><span class="n">pattern_id</span><span class="p">)])</span>
        <span class="n">n_patterns</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">patterns</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pattern_id_sel</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">pattern_id_sel</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Parameter ``pattern_id_sel`` must be a scalar&#39;</span><span class="p">)</span>
                <span class="n">pattern_id_sel</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">elif</span> <span class="n">pattern_id_sel</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pattern_id</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No pattern with id </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pattern_id_sel</span><span class="p">))</span>
                <span class="n">pattern_id_sel</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">spikelist_pattern</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_spike</span><span class="p">(</span><span class="n">pattern_id_sel</span><span class="o">=</span><span class="n">pattern_id_sel</span><span class="p">)</span>
                <span class="n">pattern_sel_pos</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pattern_id</span><span class="p">)</span> <span class="o">==</span> <span class="n">pattern_id_sel</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ax_list</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax0</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">ax_list</span> <span class="k">else</span> <span class="n">ax0</span>
        <span class="n">marker_size</span> <span class="o">=</span> <span class="mi">3</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_spikes</span> <span class="o">&gt;</span> <span class="mi">5000</span> <span class="k">else</span> <span class="mi">5</span>
        <span class="k">if</span> <span class="n">n_patterns</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ax0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spklist_sel</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">spklist_sel</span><span class="o">.</span><span class="n">channel</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">marker_size</span><span class="p">)</span>
            <span class="n">base_color</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">n_colors</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">base_color</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">n_colors</span><span class="o">=</span><span class="n">n_patterns</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">patterns_colors</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">n_colors</span><span class="o">=</span><span class="n">n_patterns</span><span class="o">+</span><span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">legend_str</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1"># Plot spikes not belonging to a pattern</span>
            <span class="k">if</span> <span class="n">spklist_sel</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">spklist_sel</span><span class="o">.</span><span class="n">pattern_id</span><span class="p">)]</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="n">ax0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spklist_sel</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">spklist_sel</span><span class="o">.</span><span class="n">pattern_id</span><span class="p">)],</span>
                         <span class="n">spklist_sel</span><span class="o">.</span><span class="n">channel</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">spklist_sel</span><span class="o">.</span><span class="n">pattern_id</span><span class="p">)],</span>
                         <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">marker_size</span><span class="p">)</span>
                <span class="n">legend_str</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">pattern_id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">patterns</span><span class="p">):</span>
                <span class="n">color_i</span> <span class="o">=</span> <span class="n">color</span> <span class="k">if</span> <span class="n">color</span> <span class="k">else</span> <span class="n">patterns_colors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">ax0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spklist_sel</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">spklist_sel</span><span class="o">.</span><span class="n">pattern_id</span> <span class="o">==</span> <span class="n">pattern_id</span><span class="p">],</span>
                         <span class="n">spklist_sel</span><span class="o">.</span><span class="n">channel</span><span class="p">[</span><span class="n">spklist_sel</span><span class="o">.</span><span class="n">pattern_id</span> <span class="o">==</span> <span class="n">pattern_id</span><span class="p">],</span>
                         <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_i</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">marker_size</span><span class="p">)</span>
                <span class="n">legend_str</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spklist_sel</span><span class="o">.</span><span class="n">pattern_names</span><span class="p">[</span><span class="n">pattern_id</span><span class="p">])</span>
            <span class="n">ax0</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legend_str</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
        <span class="n">ax0</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">)</span>
        <span class="n">ax0</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Raster plot - </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">minplot</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">ax0</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax0</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">ax_list</span> <span class="k">else</span> <span class="n">ax1</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">spklist_sel</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="nb">int</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">tmax</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmin</span><span class="p">)</span> <span class="o">/</span> <span class="n">bin_duration</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">base_color</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmax</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">)</span>
            <span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">ax0</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">ax_list</span> <span class="k">else</span> <span class="n">ax3</span>
            <span class="n">spikes_per_channel</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spklist_sel</span><span class="o">.</span><span class="n">channel</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">)]</span>
            <span class="n">ax3</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">),</span> <span class="n">spikes_per_channel</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">base_color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pattern_id_sel</span><span class="p">:</span>
                <span class="n">spikes_per_channel_pattern</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spikelist_pattern</span><span class="o">.</span><span class="n">channel</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">)]</span>
                <span class="n">ax3</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">),</span> <span class="n">spikes_per_channel_pattern</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                         <span class="n">color</span><span class="o">=</span><span class="n">patterns_colors</span><span class="p">[</span><span class="n">pattern_sel_pos</span><span class="p">],</span>  <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">))</span>
            <span class="n">ax3</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Channel&#39;</span><span class="p">)</span>
            <span class="n">ax3</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
            <span class="n">ax3</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
            <span class="n">ax3</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_right</span><span class="p">()</span>
            <span class="n">ax4</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">ax0</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">ax_list</span> <span class="k">else</span> <span class="n">ax4</span>
            <span class="n">ax4</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Channel&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Median ISI (ms)&#39;</span><span class="p">)</span>
            <span class="n">median_isi</span> <span class="o">=</span> <span class="n">spklist_sel</span><span class="o">.</span><span class="n">get_median_isi</span><span class="p">()</span>
            <span class="n">ax4</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">),</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">median_isi</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">base_color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pattern_id_sel</span><span class="p">:</span>
                <span class="n">median_isi_pattern</span> <span class="o">=</span> <span class="n">spikelist_pattern</span><span class="o">.</span><span class="n">get_median_isi</span><span class="p">()</span>
                <span class="n">ax4</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">),</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">median_isi_pattern</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                         <span class="n">color</span><span class="o">=</span><span class="n">patterns_colors</span><span class="p">[</span><span class="n">pattern_sel_pos</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">ax4</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">ax4</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
            <span class="n">ax5</span> <span class="o">=</span> <span class="n">ax4</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
            <span class="n">ax5</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">tau_lif</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">pattern_id_sel</span><span class="p">:</span>
                    <span class="n">ax5</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">median_isi_pattern</span> <span class="o">/</span> <span class="n">tau_lif</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ax5</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">median_isi</span> <span class="o">/</span> <span class="n">tau_lif</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
                <span class="n">ax5</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
                <span class="n">ax5</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">ax5</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;$ISI_{{med}} / </span><span class="se">\\</span><span class="s1">tau_{{LIF}}$&#39;</span><span class="p">)</span>
                <span class="n">ax5</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">]</span></div>

<div class="viewcode-block" id="SpikeList.plot_channel_selectivity"><a class="viewcode-back" href="../../../rst/simplecochlea.spikes.html#simplecochlea.spikes.spikelist.SpikeList.plot_channel_selectivity">[docs]</a>    <span class="k">def</span> <span class="nf">plot_channel_selectivity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title_str</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Plot channel selectivity. Definition ?</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        title_str : str</span>
<span class="sd">            Optional title for the figure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">chan_pattern_spikes</span><span class="p">,</span> <span class="n">chan_pref_pattern</span><span class="p">,</span> <span class="n">chan_selectivity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_channel_selectivity</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">chan_pattern_spikes</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">n_spikes_on_pref_pattern</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">chan_pattern_spikes</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">chan_pattern_spikes</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
        <span class="n">legend_str</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">]</span>
        <span class="n">patterns_colors</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">n_colors</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pattern_names</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">pat_id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pattern_names</span><span class="p">):</span>
            <span class="n">chan_sel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">chan_pref_pattern</span> <span class="o">==</span> <span class="n">pat_id</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">chan_sel</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">chan_sel</span><span class="p">,</span> <span class="n">n_spikes_on_pref_pattern</span><span class="p">[</span><span class="n">chan_sel</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">patterns_colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">legend_str</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pattern_names</span><span class="p">[</span><span class="n">pat_id</span><span class="p">])</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legend_str</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Number of spikes&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Number of spikes during preferred pattern - </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">title_str</span><span class="p">))</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">),</span> <span class="n">chan_selectivity</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Channel&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Pattern Selectivity&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="SpikeList.get_median_isi"><a class="viewcode-back" href="../../../rst/simplecochlea.spikes.html#simplecochlea.spikes.spikelist.SpikeList.get_median_isi">[docs]</a>    <span class="k">def</span> <span class="nf">get_median_isi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;  Compute and return the median ISI (Inter-Spike-Interval) for each channel.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        median_isi : array</span>
<span class="sd">            Median ISI for each channel of the spikelist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">median_isi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">):</span>
            <span class="n">spike_times_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">channel</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">spike_times_i</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">median_isi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">spike_times_i</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">spike_times_i</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">median_isi</span></div>

<div class="viewcode-block" id="SpikeList.get_mean_isi"><a class="viewcode-back" href="../../../rst/simplecochlea.spikes.html#simplecochlea.spikes.spikelist.SpikeList.get_mean_isi">[docs]</a>    <span class="k">def</span> <span class="nf">get_mean_isi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;  Compute and return the mean ISI (Inter-Spike-Interval) for each channel.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        mean_isi : array</span>
<span class="sd">            Mean ISI for each channel of the spikelist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mean_isi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">):</span>
            <span class="n">spike_times_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">channel</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">spike_times_i</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">mean_isi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">spike_times_i</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">spike_times_i</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">mean_isi</span></div>

<div class="viewcode-block" id="SpikeList.export"><a class="viewcode-back" href="../../../rst/simplecochlea.spikes.html#simplecochlea.spikes.spikelist.SpikeList.export">[docs]</a>    <span class="k">def</span> <span class="nf">export</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">export_path</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">export_name</span><span class="o">=</span><span class="s1">&#39;spikelist_0_&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Export the spikelist as a .mat file</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        export_path : str</span>
<span class="sd">            Export directory path (default: &#39;.&#39;)</span>
<span class="sd">        export_name : str</span>
<span class="sd">            Export file name</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">spklist_ordered</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
        <span class="n">spklist_ordered</span><span class="o">.</span><span class="n">channel</span> <span class="o">=</span> <span class="n">spklist_ordered</span><span class="o">.</span><span class="n">channel</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">spike_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">spklist_ordered</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">spklist_ordered</span><span class="o">.</span><span class="n">channel</span><span class="p">,</span> <span class="n">spklist_ordered</span><span class="o">.</span><span class="n">pattern_id</span><span class="p">,</span>
                               <span class="n">spklist_ordered</span><span class="o">.</span><span class="n">potential</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
        <span class="n">sio</span><span class="o">.</span><span class="n">savemat</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">export_path</span><span class="p">,</span> <span class="n">export_name</span><span class="p">),</span> <span class="n">mdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;spikelist&#39;</span><span class="p">:</span> <span class="n">spike_mat</span><span class="p">})</span></div>

<div class="viewcode-block" id="SpikeList.get_channel_selectivity"><a class="viewcode-back" href="../../../rst/simplecochlea.spikes.html#simplecochlea.spikes.spikelist.SpikeList.get_channel_selectivity">[docs]</a>    <span class="k">def</span> <span class="nf">get_channel_selectivity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Compute channel selectivity. Definition ?</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pattern_names</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No patterns defined - cannot compute channel selectivity&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_spikes</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No spikes - cannot compute channel selectivity&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="n">n_patterns</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pattern_names</span><span class="p">)</span>
        <span class="n">chan_pattern_spikes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">,</span> <span class="n">n_patterns</span><span class="p">))</span>
        <span class="n">pattern_spike_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_patterns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_spikes</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">pat_id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pattern_names</span><span class="p">):</span>
            <span class="n">pattern_spike_true</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pattern_id</span> <span class="o">==</span> <span class="n">pat_id</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_patterns</span><span class="p">):</span>
                <span class="n">chan_pattern_spikes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">channel</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">pattern_spike_true</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:])</span>
        <span class="n">chan_pref_pattern</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">chan_pattern_spikes</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">chan_selectivity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">)</span>
        <span class="n">chan_with_spikes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">chan_pattern_spikes</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="n">chan_selectivity</span><span class="p">[</span><span class="n">chan_with_spikes</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">chan_pattern_spikes</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">chan_with_spikes</span><span class="p">]</span> <span class="o">/</span> \
                                             <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">chan_pattern_spikes</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">chan_with_spikes</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">chan_pattern_spikes</span><span class="p">,</span> <span class="n">chan_pref_pattern</span><span class="p">,</span> <span class="n">chan_selectivity</span></div>

<div class="viewcode-block" id="SpikeList.to_dataframe"><a class="viewcode-back" href="../../../rst/simplecochlea.spikes.html#simplecochlea.spikes.spikelist.SpikeList.to_dataframe">[docs]</a>    <span class="k">def</span> <span class="nf">to_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Convert the spikelist to a dataframe containing 3 fields : &#39;time&#39;, &#39;channel&#39; and &#39;pattern_id&#39;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        df : Pandas DataFrame</span>
<span class="sd">            The spikelist as a dataframe</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="s1">&#39;channel&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel</span><span class="p">,</span> <span class="s1">&#39;pattern_id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pattern_id</span><span class="p">},</span>
                          <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;channel&#39;</span><span class="p">,</span> <span class="s1">&#39;pattern_id&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="SpikeList.convert_to_packet"><a class="viewcode-back" href="../../../rst/simplecochlea.spikes.html#simplecochlea.spikes.spikelist.SpikeList.convert_to_packet">[docs]</a>    <span class="k">def</span> <span class="nf">convert_to_packet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">packet_size</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Deprecated. Used to convert the spikelist to spike packets &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">packet_size</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Argument packet size must be a scalar&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">overlap</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">overlap</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Argument overlap must be between 0 and 1&#39;</span><span class="p">)</span>
        <span class="n">n_overlap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">packet_size</span> <span class="o">*</span> <span class="n">overlap</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n_overlap</span> <span class="o">==</span> <span class="n">packet_size</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Set overlap to packet_size - 1 : </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">packet_size</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">n_overlap</span> <span class="o">=</span> <span class="n">packet_size</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">n_overlap</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">n_max_packets</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_spikes</span> <span class="o">/</span> <span class="n">packet_size</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n_max_packets</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_spikes</span> <span class="o">/</span> <span class="p">(</span><span class="n">packet_size</span> <span class="o">-</span> <span class="n">n_overlap</span><span class="p">)))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">n_overlap</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Overlap is not handled correctly - set it to 0&#39;</span><span class="p">)</span>
            <span class="n">n_overlap</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">spklist_sorted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
        <span class="c1"># Binary matrix size (n_channel, n_packets)</span>
        <span class="n">packet_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">,</span> <span class="n">n_max_packets</span><span class="p">))</span>
        <span class="c1"># Matrix (n_channel, n_packets) containing either 0 or the spike&#39;s index in the original spikelist</span>
        <span class="n">index_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">,</span> <span class="n">n_max_packets</span><span class="p">))</span>
        <span class="c1"># Maximal spike time for each packet</span>
        <span class="n">packet_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_max_packets</span><span class="p">)</span>
        <span class="n">i_start</span><span class="p">,</span> <span class="n">i_packet</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">i_start</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_spikes</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Get the packet_size first unique spikes in the list (sorted by time)</span>
            <span class="n">k_start</span> <span class="o">=</span> <span class="mi">3</span>
            <span class="n">unique_chan</span><span class="p">,</span> <span class="n">spk_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">spklist_sorted</span><span class="o">.</span><span class="n">channel</span><span class="p">[</span><span class="n">i_start</span><span class="p">:</span><span class="nb">min</span><span class="p">(</span><span class="n">i_start</span> <span class="o">+</span> <span class="n">k_start</span> <span class="o">*</span> <span class="n">packet_size</span><span class="p">,</span>
                                                                                <span class="n">spklist_sorted</span><span class="o">.</span><span class="n">n_spikes</span><span class="p">)],</span>
                                             <span class="n">return_index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">time_sort_vect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">spk_ind</span><span class="p">)</span>
            <span class="n">unique_chan</span> <span class="o">=</span> <span class="n">unique_chan</span><span class="p">[</span><span class="n">time_sort_vect</span><span class="p">]</span>
            <span class="n">spk_ind</span> <span class="o">=</span> <span class="n">spk_ind</span><span class="p">[</span><span class="n">time_sort_vect</span><span class="p">]</span>
            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_chan</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">packet_size</span><span class="p">:</span>
                <span class="n">k_start</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">unique_chan</span><span class="p">,</span> <span class="n">spk_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span>
                    <span class="n">spklist_sorted</span><span class="o">.</span><span class="n">channel</span><span class="p">[</span><span class="n">i_start</span><span class="p">:</span><span class="nb">min</span><span class="p">(</span><span class="n">i_start</span> <span class="o">+</span> <span class="n">k_start</span> <span class="o">*</span> <span class="n">packet_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_spikes</span><span class="p">)],</span>
                    <span class="n">return_index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">i_start</span> <span class="o">+</span> <span class="n">k_start</span> <span class="o">*</span> <span class="n">packet_size</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_spikes</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="c1"># unique_chan : position of the channels that spiked</span>
            <span class="c1"># spk_ind : relative index of the unique spikes in the spike list (with offset i_start) [sorted by time]</span>
            <span class="n">unique_chan</span> <span class="o">=</span> <span class="n">unique_chan</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">unique_chan</span><span class="p">,</span> <span class="n">spk_ind</span> <span class="o">=</span> <span class="n">unique_chan</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">packet_size</span><span class="p">],</span> <span class="n">spk_ind</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">packet_size</span><span class="p">]</span>
            <span class="n">packet_matrix</span><span class="p">[</span><span class="n">unique_chan</span><span class="p">,</span> <span class="n">i_packet</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">index_matrix</span><span class="p">[</span><span class="n">unique_chan</span><span class="p">,</span> <span class="n">i_packet</span><span class="p">]</span> <span class="o">=</span> <span class="n">spk_ind</span>
            <span class="n">packet_time</span><span class="p">[</span><span class="n">i_packet</span><span class="p">]</span> <span class="o">=</span> <span class="n">spklist_sorted</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">i_start</span> <span class="o">+</span> <span class="n">spk_ind</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
            <span class="c1"># Increment i_start</span>
            <span class="n">i_start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i_start</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">spk_ind</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">n_overlap</span><span class="p">)</span>
            <span class="c1"># if n_overlap:</span>
            <span class="c1">#     i_start = i_start + 1 + spk_ind[packet_size]</span>
            <span class="c1"># else:</span>
            <span class="c1">#     i_start = i_start + packet_size - n_overlap</span>
            <span class="n">i_packet</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_chan</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">packet_size</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="n">packet_matrix</span> <span class="o">=</span> <span class="n">packet_matrix</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">i_packet</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">index_matrix</span> <span class="o">=</span> <span class="n">index_matrix</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">i_packet</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">packet_time</span> <span class="o">=</span> <span class="n">packet_time</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i_packet</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">packet_matrix</span><span class="p">,</span> <span class="n">index_matrix</span><span class="p">,</span> <span class="n">packet_time</span></div></div>


<div class="viewcode-block" id="SpikeList_list"><a class="viewcode-back" href="../../../rst/simplecochlea.spikes.html#simplecochlea.spikes.spikelist.SpikeList_list">[docs]</a><span class="k">class</span> <span class="nc">SpikeList_list</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; SpikeList_list Class.</span>
<span class="sd">     Defines a list of SpikeList instances. Can represents differents epochs of a global spikelist, spikelists</span>
<span class="sd">     corresponding to repetitions of a pattern.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spikelist_list</span><span class="p">,</span> <span class="n">t_start</span><span class="o">=</span><span class="p">[],</span> <span class="n">t_end</span><span class="o">=</span><span class="p">[]):</span>
        <span class="n">t_start</span><span class="p">,</span> <span class="n">t_end</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">t_start</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">t_end</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">t_start</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">t_start</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">t_start</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">t_end</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">t_end</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">t_end</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="n">spikelist_list</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">spikelist_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">spikelist_list</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">t_start</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">t_end</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">spikelist_list</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_start</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_end</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Arguments spikelist_list and t_start and t_end must have the same length&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_spikelist</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spikelist_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spikelist_list</span> <span class="o">=</span> <span class="n">spikelist_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_spikes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">n_spikes</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">spikelist_list</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">tmax</span> <span class="o">-</span> <span class="n">s</span><span class="o">.</span><span class="n">tmin</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">spikelist_list</span><span class="p">])</span>
        <span class="n">name_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">n_channels_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_spikelist</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">t_start</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spikelist_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">spikelist_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">add_time_offset</span><span class="p">(</span><span class="o">-</span><span class="n">t_start</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spikelist_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tmin</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spikelist_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tmax</span> <span class="o">=</span> <span class="n">t_end</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">t_start</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spikelist_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">spikelist_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">name_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spikelist_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">n_channels_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spikelist_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">n_channels</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tmin</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">tmax</span> <span class="o">-</span> <span class="n">s</span><span class="o">.</span><span class="n">tmin</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">spikelist_list</span><span class="p">]))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">name_list</span><span class="p">)))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">n_channels_list</span><span class="p">)))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;All spike lists should have the same number of channels&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span> <span class="o">=</span> <span class="n">n_channels_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;SpikeList_list containing </span><span class="si">{}</span><span class="s1"> spike lists with </span><span class="si">{}</span><span class="s1"> channels&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_spikelist</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">spikelist_list</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="nb">slice</span><span class="p">:</span>
            <span class="n">spikelist_list_sel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spikelist_list</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;bool&#39;</span><span class="p">:</span>
                <span class="n">item</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">item</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">spikelist_list_sel</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">spikelist_list</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">item</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">SpikeList_list</span><span class="p">(</span><span class="n">spikelist_list_sel</span><span class="p">)</span>

<div class="viewcode-block" id="SpikeList_list.plot"><a class="viewcode-back" href="../../../rst/simplecochlea.spikes.html#simplecochlea.spikes.spikelist.SpikeList_list.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_max_cols</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">plot_vr_dist</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Plot all the spikelist in the same figure</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        n_max_cols : int</span>
<span class="sd">            Maximal number of columns.</span>
<span class="sd">        plot_vr_dist : bool (default: False)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">plot_vr_dist</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">plot_vr_dist</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">n_rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_spikelist</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_max_cols</span><span class="o">-</span><span class="n">plot_vr_dist</span><span class="p">)))</span>
        <span class="n">n_cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_spikelist</span> <span class="o">+</span> <span class="n">plot_vr_dist</span> <span class="k">if</span> <span class="n">n_rows</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">n_max_cols</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax_list</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(),</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">spklist</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spikelist_list</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">n_cols</span><span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">plot_vr_dist</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">transFigure</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sharey</span><span class="o">=</span><span class="n">ax_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">spklist</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax_list</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">minplot</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ax_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Epoch </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="s1">&#39;Epoch </span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1"> spikes&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">spklist</span><span class="o">.</span><span class="n">n_spikes</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">/</span> <span class="n">n_cols</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="n">n_cols</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Channel&#39;</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">plot_vr_dist</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">vr_dist</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">global_vr_dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_vanrossum_distance</span><span class="p">()</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">ax_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">),</span> <span class="n">vr_dist</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Van Rossum Distance&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Mean VR distance : </span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">global_vr_dist</span><span class="p">))</span></div>

<div class="viewcode-block" id="SpikeList_list.plot_superpose"><a class="viewcode-back" href="../../../rst/simplecochlea.spikes.html#simplecochlea.spikes.spikelist.SpikeList_list.plot_superpose">[docs]</a>    <span class="k">def</span> <span class="nf">plot_superpose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot_fano_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">plot_vr_dist</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Plot all the spikelists of the SpikeList_list superimposed on the same axes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        plot_fano_factor : bool (default: True)</span>
<span class="sd">            If True, plot the Fano Factor</span>
<span class="sd">        plot_vr_dist : bool (default: True)</span>
<span class="sd">            If True, plot the mean Van-Rossum distance</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">n_colors</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_spikelist</span><span class="p">)</span>
        <span class="n">legend_str</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Epoch </span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1"> spikes&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">spikelist_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">n_spikes</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_spikelist</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">spklist</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spikelist_list</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spklist</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">spklist</span><span class="o">.</span><span class="n">channel</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Channel&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legend_str</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">plot_fano_factor</span><span class="p">:</span>
            <span class="n">fano_factor</span><span class="p">,</span> <span class="n">mean_fano_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_fano_factor</span><span class="p">()</span>
            <span class="n">ax_ff</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
            <span class="n">ax_ff</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">),</span> <span class="n">fano_factor</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ax_ff</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">ax_ff</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Fano Factor&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Channel&#39;</span><span class="p">,</span>
                      <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Mean Fano Factor : </span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mean_fano_factor</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">plot_vr_dist</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">vr_dist</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">global_vr_dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_vanrossum_distance</span><span class="p">()</span>
            <span class="n">ax_vr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
            <span class="n">ax_vr</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">),</span> <span class="n">vr_dist</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ax_vr</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">ax_vr</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
            <span class="n">ax_vr</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Van Rossum Distance&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Mean VR distance : </span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">global_vr_dist</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="SpikeList_list.compute_channel_with_spikes"><a class="viewcode-back" href="../../../rst/simplecochlea.spikes.html#simplecochlea.spikes.spikelist.SpikeList_list.compute_channel_with_spikes">[docs]</a>    <span class="k">def</span> <span class="nf">compute_channel_with_spikes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get proportion of channel with spikes in all epochs</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        channel_with_spikes_ratio : array</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">spikes_in_channel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_spikelist</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">spklist</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spikelist_list</span><span class="p">):</span>
            <span class="n">spikes_in_channel</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">spklist</span><span class="o">.</span><span class="n">channel</span><span class="p">),</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">channel_with_spikes_ind</span> <span class="o">=</span> <span class="n">spikes_in_channel</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_spikelist</span>
        <span class="n">channel_with_spikes_ratio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">channel_with_spikes_ind</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span>
        <span class="k">return</span> <span class="n">channel_with_spikes_ratio</span></div>

<div class="viewcode-block" id="SpikeList_list.compute_spike_per_channel_variation"><a class="viewcode-back" href="../../../rst/simplecochlea.spikes.html#simplecochlea.spikes.spikelist.SpikeList_list.compute_spike_per_channel_variation">[docs]</a>    <span class="k">def</span> <span class="nf">compute_spike_per_channel_variation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Compute the coefficient of variation of the number of spikes per channel for each spikelist</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        var_coeff, var_coeff_mean</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">var_coeff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_spikelist</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">spklist</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spikelist_list</span><span class="p">):</span>
            <span class="n">spk_per_channel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spklist</span><span class="o">.</span><span class="n">channel</span> <span class="o">==</span> <span class="n">i_chan</span><span class="p">)</span> <span class="k">for</span> <span class="n">i_chan</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">)])</span>
            <span class="n">var_coeff</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">spk_per_channel</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">/</span> <span class="n">spk_per_channel</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">if</span> <span class="n">spk_per_channel</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">var_coeff</span><span class="p">,</span> <span class="n">var_coeff</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span></div>

<div class="viewcode-block" id="SpikeList_list.compute_vanrossum_distance"><a class="viewcode-back" href="../../../rst/simplecochlea.spikes.html#simplecochlea.spikes.spikelist.SpikeList_list.compute_vanrossum_distance">[docs]</a>    <span class="k">def</span> <span class="nf">compute_vanrossum_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cos</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mf">0.001</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         Compute the van Rossum distance (see: A Novel Spike Distance  - M. C. W. van Rossum).</span>
<span class="sd">         Also compute the distance normalized by sqrt((M+N)/2) where M and N are the number of spikes in the 2 spike</span>
<span class="sd">         trains. This way the normalized distance between 2 uncorrelated Poisson spike trains in 1. The result is</span>
<span class="sd">         divided by sqrt(2) due to the implementation in pymuvr to get similar results as in the original paper.</span>

<span class="sd">         The function return the mean of these distance across each comparison of the spikelist_list for each channel.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cos : float</span>
<span class="sd">            ??? - Does not seem to have much influence</span>
<span class="sd">        tau : float</span>
<span class="sd">            Time constant for the exponential tail</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        mean_vr_dist</span>

<span class="sd">        mean_vr_dist_norm :</span>

<span class="sd">        global_vr_dist:</span>

<span class="sd">        global_vr_dist_norm</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">HAS_PYMUVR</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s1">&#39;pymuvr is not installed/available&#39;</span><span class="p">)</span>
        <span class="n">mean_vr_dist</span><span class="p">,</span> <span class="n">spikes_in_chan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">)</span>
        <span class="n">mean_vr_dist_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">)</span>
        <span class="n">up_i</span><span class="p">,</span> <span class="n">up_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu_indices</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_spikelist</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i_chan</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">):</span>
            <span class="n">obs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">spklist</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">spikelist_list</span><span class="p">:</span>
                <span class="n">obs</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="n">spklist</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">spklist</span><span class="o">.</span><span class="n">channel</span> <span class="o">==</span> <span class="n">i_chan</span><span class="p">])])</span>
                <span class="n">spk_counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spklist</span><span class="o">.</span><span class="n">channel</span> <span class="o">==</span> <span class="n">i_chan</span><span class="p">)</span> <span class="k">for</span> <span class="n">spklist</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">spikelist_list</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">vr_dist</span> <span class="o">=</span> <span class="n">pymuvr</span><span class="o">.</span><span class="n">square_dissimilarity_matrix</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="s1">&#39;distance&#39;</span><span class="p">)</span>
                <span class="n">mean_vr_dist</span><span class="p">[</span><span class="n">i_chan</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">vr_dist</span><span class="p">[</span><span class="n">up_i</span><span class="p">,</span> <span class="n">up_j</span><span class="p">])</span>
                <span class="n">norm_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">spk_counts</span><span class="p">,</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">obs</span><span class="p">),</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">spk_counts</span><span class="p">,</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">obs</span><span class="p">),</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">vr_dist_norm</span> <span class="o">=</span> <span class="n">vr_dist</span> <span class="o">/</span> <span class="p">(</span><span class="n">norm_mat</span> <span class="o">+</span> <span class="mf">1e-8</span><span class="p">)</span>
                <span class="n">mean_vr_dist_norm</span><span class="p">[</span><span class="n">i_chan</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">vr_dist_norm</span><span class="p">[</span><span class="n">up_i</span><span class="p">,</span> <span class="n">up_j</span><span class="p">])</span>
                <span class="n">spikes_in_chan</span><span class="p">[</span><span class="n">i_chan</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">global_vr_dist</span> <span class="o">=</span> <span class="n">mean_vr_dist</span><span class="p">[</span><span class="n">spikes_in_chan</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">global_vr_dist_norm</span> <span class="o">=</span> <span class="n">mean_vr_dist_norm</span><span class="p">[</span><span class="n">spikes_in_chan</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">mean_vr_dist</span><span class="p">,</span> <span class="n">mean_vr_dist_norm</span><span class="p">,</span> <span class="n">global_vr_dist</span><span class="p">,</span> <span class="n">global_vr_dist_norm</span></div>

<div class="viewcode-block" id="SpikeList_list.compute_fano_factor"><a class="viewcode-back" href="../../../rst/simplecochlea.spikes.html#simplecochlea.spikes.spikelist.SpikeList_list.compute_fano_factor">[docs]</a>    <span class="k">def</span> <span class="nf">compute_fano_factor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Compute the Fano Factor (~dispersion) of the number of spikes in each spike list, for each channel.</span>
<span class="sd">        Fano factor is defined as the variance divided by the mean of a random process</span>
<span class="sd">        The global fano factor returned is the mean across channels</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fano_factor :</span>

<span class="sd">        global_fano_factor :</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">fano_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i_chan</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">):</span>
            <span class="n">spk_counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spklist</span><span class="o">.</span><span class="n">channel</span> <span class="o">==</span> <span class="n">i_chan</span><span class="p">)</span> <span class="k">for</span> <span class="n">spklist</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">spikelist_list</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">spk_counts</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">fano_factor</span><span class="p">[</span><span class="n">i_chan</span><span class="p">]</span> <span class="o">=</span> <span class="n">spk_counts</span><span class="o">.</span><span class="n">var</span><span class="p">()</span> <span class="o">/</span> <span class="n">spk_counts</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fano_factor</span><span class="p">[</span><span class="n">i_chan</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">fano_factor</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">global_fano_factor</span> <span class="o">=</span> <span class="n">fano_factor</span><span class="p">[</span><span class="n">fano_factor</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">global_fano_factor</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">fano_factor</span><span class="p">,</span> <span class="n">global_fano_factor</span></div></div>


<div class="viewcode-block" id="import_spikelist_from_mat"><a class="viewcode-back" href="../../../rst/simplecochlea.spikes.html#simplecochlea.spikes.spikelist.import_spikelist_from_mat">[docs]</a><span class="k">def</span> <span class="nf">import_spikelist_from_mat</span><span class="p">(</span><span class="n">import_path</span><span class="p">,</span> <span class="n">n_channels</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Import a spikelist (SpikeList instance) from a .mat file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    import_path : str</span>
<span class="sd">        Spikelist file path</span>
<span class="sd">    n_channels : int</span>
<span class="sd">        Number of channels in the spikelist - Now is included in the spikelist.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    spikelist : SpikeList</span>
<span class="sd">        The SpikeList instance.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mat_file</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="n">import_path</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">spikelist_data</span> <span class="o">=</span> <span class="n">mat_file</span><span class="p">[</span><span class="s1">&#39;spikelist&#39;</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">spikelist_data</span> <span class="o">=</span> <span class="n">mat_file</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">mat_file</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Could not read spike list&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">spikelist_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">potential</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">spikelist_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">potential</span> <span class="o">=</span> <span class="n">spikelist_data</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">SpikeList</span><span class="p">(</span><span class="n">spikelist_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">spikelist_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">spikelist_data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">potential</span><span class="p">,</span>
                     <span class="n">n_channels</span><span class="o">=</span><span class="n">n_channels</span><span class="p">)</span></div>


<div class="viewcode-block" id="dual_spikelist_plot"><a class="viewcode-back" href="../../../rst/simplecochlea.spikes.html#simplecochlea.spikes.spikelist.dual_spikelist_plot">[docs]</a><span class="k">def</span> <span class="nf">dual_spikelist_plot</span><span class="p">(</span><span class="n">spikelist_in</span><span class="p">,</span> <span class="n">spikelist_out</span><span class="p">,</span> <span class="n">potential_thresh_in</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">potential_thresh_out</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">tau_lif</span><span class="o">=</span><span class="p">[],</span>
                        <span class="n">pattern_id_sel_in</span><span class="o">=</span><span class="p">[],</span> <span class="n">pattern_id_sel_out</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">&quot;&quot;&quot; Dual Spikelist Plot. </span>
<span class="sd">     Plot 2 spikelists in the same figure. Useful when the two spikelist share common parameters.</span>
<span class="sd">     The second spikelist can be obtained from the first one, after running a learning rule for example. </span>
<span class="sd">     First/Top spikelist is defined by spikelist_in and the second/bottom spikelist is defined by spikelist_out</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    spikelist_in : SpikeList</span>
<span class="sd">        First spikelist, plot on top</span>
<span class="sd">    spikelist_out : SpikeList</span>
<span class="sd">        Second spikelist, plot at the bottom</span>
<span class="sd">    potential_thresh_in : float</span>
<span class="sd">        If defined, only spikes of spikelist_in whose threshold is superior to this value will be plot.</span>
<span class="sd">    potential_thresh_out : float</span>
<span class="sd">        If defined, only spikes of spikelist_out whose threshold is superior to this value will be plot.</span>
<span class="sd">    tau_lif : array</span>
<span class="sd">        Tau value of the LIF neurons of the cochlea (used to generate these spikelists).</span>
<span class="sd">    pattern_id_sel_in : int</span>
<span class="sd">        If defined, only spikes of spikelist_in with this ID will be plot</span>
<span class="sd">    pattern_id_sel_out : int</span>
<span class="sd">        If defined, only spikes of spikelist_out with this ID will be plot</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    [ax0, ax1, ..., ax7] : list</span>
<span class="sd">        A list of all the axes</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">ax0</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax0</span><span class="p">)</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">ax0</span><span class="p">)</span>
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">ax0</span><span class="p">)</span>
    <span class="n">ax_list</span> <span class="o">=</span> <span class="n">spikelist_in</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax_list</span><span class="o">=</span><span class="p">[</span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">],</span> <span class="n">potential_thresh</span><span class="o">=</span><span class="n">potential_thresh_in</span><span class="p">,</span> <span class="n">tau_lif</span><span class="o">=</span><span class="n">tau_lif</span><span class="p">,</span>
                                 <span class="n">pattern_id_sel</span><span class="o">=</span><span class="n">pattern_id_sel_in</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">spikelist_in</span><span class="o">.</span><span class="n">n_spikes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ax_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">ax0</span> <span class="o">=</span> <span class="n">ax_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ax4</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax0</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">ax0</span><span class="p">)</span>
    <span class="n">ax5</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax0</span><span class="p">)</span>
    <span class="n">ax6</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">ax0</span><span class="p">)</span>
    <span class="n">ax7</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">spikelist_out</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax_list</span><span class="o">=</span><span class="p">[</span><span class="n">ax4</span><span class="p">,</span> <span class="n">ax5</span><span class="p">,</span> <span class="n">ax6</span><span class="p">,</span> <span class="n">ax7</span><span class="p">],</span> <span class="n">potential_thresh</span><span class="o">=</span><span class="n">potential_thresh_out</span><span class="p">,</span>
                        <span class="n">pattern_id_sel</span><span class="o">=</span><span class="n">pattern_id_sel_out</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">legend</span><span class="p">([])</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="n">spikelist_in</span><span class="o">.</span><span class="n">tmin</span><span class="p">,</span> <span class="n">spikelist_in</span><span class="o">.</span><span class="n">tmax</span><span class="p">))</span>
    <span class="n">f</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">,</span> <span class="n">ax5</span><span class="p">,</span> <span class="n">ax6</span><span class="p">,</span> <span class="n">ax7</span><span class="p">]</span></div>

</pre></div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018, Martin Deudon.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.4.<br/>
    </p>
  </div>
</footer>
  </body>
</html>